<html>
  <head>
    <title>Wordle Results</title>
    <link rel="shortcut icon" type="image/png" href="wr.png"> 
    <style>
      * {font-family: Arial, sans-serif;
        }
 /*     table, td, th {
        border: 1px solid;
        padding: 10px;
      } */
    </style>
    <style>
      .table-container {
      height: 600px;              /* enough for ~10 rows */
      overflow-y: auto;         /* vertical scrollbar */
      position: relative;
      display: block;
      border: 1px solid #ccc;
      margin: auto;
      width: 98%;
      background-color: white;
      }
    </style>

    <style>
    .center-container {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 75%;
    }
    .left-text {
      text-align: center;
      font-size: 36px;
      min-width: 250px; /* Optional: ensures visible width */
    }
  </style>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.0.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>


  </head>
  
  <body>
    
    <div id="nothing" style="display: block">
      <br/><p align=center style="font-size: 54px; color: blue;"><strong><i>Loading results. Please wait...</i></strong></p>   
    </div>
    
    <div id="everything" style="display: none">
      
      <br/><p align=center style="font-size: 54px; color: blue;"><strong><i>This Year's Results</i></strong></p>
      <p align=center style="font-size: 30px;"><i>Scroll this panel to view more rows</i></p>
     
      <table style="font-size: 48px; padding: 6px" align=center>
        <thead><tr><th align=center width=300px style="border: none">Date</th><th align=left width=150px style="border: none">Word</th><th align=center width=120px style="border: none">Chris</th><th align=center width=120px style="border: none">Julia</th><th align=center width=120px style="border: none">Nick</th></tr></thead>
      </table>
      
       <div class="table-container" id="scrollTable">

      <table style="font-size: 48px; padding: 6px" align=center>
        <tbody id="table-body"></tbody>
      </table>
     <div id="spacer" style="height: 0;"></div>
   </div>

      <hr>
      <hr>

    <p align=center style="font-size: 54px; color: blue;"><strong><i>Outright Wins</i></strong></p>
    <canvas id="wins-donut-chart" width="600" height="400"></canvas>
      <hr>
    <hr>
    <p align=center style="font-size: 54px; color: blue;"><strong><i>Outright Losses</i></strong></p>
    <canvas id="losses-donut-chart" width="600" height="400"></canvas>
      <hr>
    <hr>
    <p align=center style="font-size: 54px; color: blue;"><strong><i>Guess Distribution</i></strong></p>
    <canvas id="guesses-bar-chart" width="600" height="800"></canvas>
      <hr>
    <hr>

    <p align=center style="font-size: 54px; color: blue;"><strong><i>Total Guesses</i></strong></p>

   <table style="font-size: 48px; padding: 6px" align=center width=80%>
<tr><td id="totalGuesses">
    </td>
  </tr>
</table>
        <hr>
   <hr>
    
     <div id="newWord" style="display: none">
        
      <p align=center style="font-size: 54px; color: blue;"><strong><i>Add New Wordle Entry</i></strong></p>

      <form id="entry-form" style="font-size: 30px;">
 
      <label for="the-date">Date:</label>
      <input type="text" id="the-date" maxlength="10" style="font-size: 30px; width: 170px" name="thedate" required>

      <label for="the-word">Word:</label>
      <input type="text" id="the-word" maxlength="5" style="font-size: 30px; width: 150px; text-transform:uppercase" name="theword" required>

      <label for="xchris">Chris:</label>
      <input type="number" maxlength="1" id="xchris" style="font-size: 30px; width: 60px;" name="chris" required>
      <label for="xjulia">Julia:</label>
      <input type="number" maxlength="1" id="xjulia" style="font-size: 30px; width: 60px;" name="julia" required>
      <label for="xnick">Nick:</label>
      <input type="number" maxlength="1" id="xnick" style="font-size: 30px; width: 60px;" name="nick" required>
      <br><br>
      <div style="text-align: center;">
        <button type="submit" style="font-size: 36px">Submit</button>
      </div>

    </form>
    <hr>
      <hr>
      </div> <!-- id="newWord" -->

      <br/><p align=center style="font-size: 54px; color: blue;"><strong><i>Previous Results</i></strong></p>
      <p align=center style="font-size: 30px;"><i>Scroll this panel to view more rows</i></p>
     
         <table style="font-size: 48px; padding: 6px" align=center>
        <thead><tr><th align=center width=300px style="border: none">Date</th><th align=left width=150px style="border: none">Word</th>      <th width=120px align='center' style='border: none;'>Chris</th><th width=120px align='center' style='border: none;'>Julia</th><th width=120px align='center' style='border: none;'>Nick</th>
</tr></thead>
      </table>
      
    <div class="table-container" id="scrollTable2">

      <table style="font-size: 48px; padding: 6px" align=center>
        <tbody id="table-body2"></tbody>
      </table>
     <div id="spacer2" style="height: 0;"></div>
   </div>
      <hr>
      <hr>

  </div> <!-- id="everything" -->
    
    <script src="previous.js"></script>

  <script>

if (!(/iPhone/.test(navigator.userAgent))) {
  document.getElementById('newWord').style.display = 'block';
}



Chart.register(ChartDataLabels);
    
    let today = new Date();
 
    let dd = today.getDate();
    let mm = today.getMonth() + 1; // Months are zero-based
    let yyyy = today.getFullYear();

    dd = dd < 10 ? '0' + dd : dd;
    mm = mm < 10 ? '0' + mm : mm;

    let formattedDate = dd + '/' + mm + '/' + yyyy;

    document.getElementById('the-date').value = formattedDate;

    const entryForm = document.getElementById('entry-form');
    const tableBody = document.getElementById('table-body');
    const tableBody2 = document.getElementById('table-body2');
     
    const winDonutChartCtx = document.getElementById('wins-donut-chart').getContext('2d');
    const lossesDonutChartCtx = document.getElementById('losses-donut-chart').getContext('2d');
    const guessesBarChartCtx = document.getElementById('guesses-bar-chart').getContext('2d');
  
      //let prevTotal = 0;
    let winChart; // Holds Chart.js instance
    let lossesChart; // Holds Chart.js instance
    let guessesChart; // Holds Chart.js instance

    async function fetchDataAndUpdateUI() {
      const response = await fetch('https://script.google.com/macros/s/AKfycbzaH1euvAcQ3j-xP0R6BBOpvvy4-b7AygK2jEp0MJEfcdgpanuyQ6-2Nl0f3fT9rLpF/exec?sheet=2025');
      const data = await response.json();

      tableBody.innerHTML = '';
      let indx = 0;
        
      let chrisWins = 0;
      let juliaWins = 0;
      let nickWins = 0;
      let noOneWins = 0;
        
      let chrisLosses = 0;
      let juliaLosses = 0;
      let nickLosses = 0;
      let noOneLosses = 0;
        
      let chrisBG;
      let juliaBG;
      let nickBG;

      let chrisCount = 0;
      let juliaCount = 0;
      let nickCount = 0;
      
      let chrisGoes = [0,0,0,0,0,0,0];
      let juliaGoes = [0,0,0,0,0,0,0];
      let nickGoes = [0,0,0,0,0,0,0];
        
      data.forEach(myRow => {

        chrisCount = chrisCount + myRow.Chris;
        juliaCount = juliaCount + myRow.Julia;
        nickCount = nickCount + myRow.Nick;

        chrisGoes[myRow.Chris-1]++;
        juliaGoes[myRow.Julia-1]++;
        nickGoes[myRow.Nick-1]++;  

        chrisBG = "white";
        juliaBG = "white";
        nickBG = "white";
          
        if (myRow.Chris < myRow.Julia && myRow.Chris < myRow.Nick) {
          chrisBG = "lightgreen";
          chrisWins = chrisWins + 1;
        } else if (myRow.Julia < myRow.Chris && myRow.Julia < myRow.Nick) {
          juliaBG = "lightgreen";
          juliaWins = juliaWins + 1;
        } else if (myRow.Nick < myRow.Chris && myRow.Nick < myRow.Julia) {
          nickBG = "lightgreen";
          nickWins = nickWins + 1;
        } else {
          noOneWins = noOneWins + 1;
        }

        if (myRow.Chris > myRow.Julia && myRow.Chris > myRow.Nick) {
          chrisBG = "lightpink";
          chrisLosses = chrisLosses + 1;
        } else if (myRow.Julia > myRow.Chris && myRow.Julia > myRow.Nick) {
          juliaBG = "lightpink";
          juliaLosses = juliaLosses + 1;
        } else if (myRow.Nick > myRow.Chris && myRow.Nick > myRow.Julia) {
          nickBG = "lightpink";
          nickLosses = nickLosses + 1;
        } else {
          noOneLosses = noOneLosses + 1;
        }

        if (myRow.Chris == 7) {chrisBG = "lemonchiffon"};
        if (myRow.Julia == 7) {juliaBG = "lemonchiffon"};
        if (myRow.Nick  == 7) {nickBG =  "lemonchiffon"};
                               

        //if (indx >= (data.length - 10)) {
          tableBody.innerHTML += `<tr><td  width=300px style="border: none" align='center'>${myRow["TheDate"]}</td><td width=150px style="border: none" align='left'>${myRow["TheWord"]}</td><td width=120px align='center' style='border: none; background-color: ${chrisBG}'>${myRow["Chris"]}</td><td width=120px align='center' style='border: none; background-color: ${juliaBG}'>${myRow["Julia"]}</td><td width=120px align='center' style='border: none; background-color: ${nickBG}'>${myRow["Nick"]}</td></tr>`;
        //}
        indx = indx + 1;
      }); //data.forEach
      
//      console.log (chrisCount, juliaCount, nickCount);
      
    const totalGuesses = document.getElementById('totalGuesses');

    totalGuesses.innerHTML = `<div align=center><strong><span style="color: lightblue">Chris</span></strong> has made <strong><span style="color: lightblue">${chrisCount}</span></strong> guesses.<br/><br/><strong><span style="color: lightpink">Julia</span></strong> has made <strong><span style="color: lightpink">${juliaCount}</span></strong> guesses.<br/><br/><strong><span style="color: lightgreen">Nick</span></strong> has made <strong><span style="color: lightgreen">${nickCount}</span></strong> guesses.<br/><br/></div>`;
      
      // const container = document.getElementById('scrollTable');
      
  //container.scrollTop = container.scrollHeight;

        
//console.log(chrisGoes, juliaGoes, nickGoes);
        
    //    console.log(chrisWins, juliaWins, nickWins, noOneWins, chrisLosses, juliaLosses, nickLosses, noOneLosses);
  // Prepare chart data
  //      const atEndOf = data.map(row => row["AtEndOf"]);
   //     const total = data.map(row => row["Total"]);

      const winData = {
        labels: [
          'Chris',
          'Julia',
          'Nick',
          'No OW'
        ], //labels
        datasets: [{
          label: 'Wins',
          data: [chrisWins, juliaWins, nickWins, noOneWins],
          backgroundColor: [
            '#6495ed',
            '#eb2d53',
            '#609f60',
            '#ffec80'
          ], //backgroundColor
          hoverOffset: 4
        }] //datasets
      }; //winData

      const lossesData = {
        labels: [
          'Chris',
          'Julia',
          'Nick',
          'No OL'
        ], //labels
        datasets: [{
          label: 'Losses',
          data: [chrisLosses, juliaLosses, nickLosses, noOneLosses],
          backgroundColor: [
            'lightblue',
            'lightpink',
            'lightgreen',
            'lemonchiffon'
          ], //backgroundColor
          hoverOffset: 4
        }] //datasets
      }; //lossesData
        
      if (winChart) {
        winChart.data.datasets[0].data[0] = chrisWins;
        winChart.data.datasets[0].data[1] = juliaWins;
        winChart.data.datasets[0].data[2] = nickWins;
        winChart.data.datasets[0].data[3] = noOneWins;
        winChart.update();
      } else {
        winChart = new Chart(winDonutChartCtx, {
          type: 'doughnut',
          data: winData,
          options: {
            plugins: {
    datalabels: {
      anchor: 'center',      // position of label relative to bar segment
      align: 'center',       // alignment of label inside segment
  //    color: 'white',        // label color
      font: {
    //    weight: 'bold',
        size: 30
      },
       formatter: (value, ctx) => {
          const label = ctx.chart.data.labels[ctx.dataIndex];
          return label + ': ' + value;
        }
      }, //datalabels
            legend: {
              display: false,
                labels: {
                  enabled: false
   //               font: {
    //                size: 30
    //              }, //font
                } //labels
              }, //legend
    //          title: {
    //            display: true,
    //            text: "Outright Wins"
    //          }, //title
               tooltip: {
                 enabled: false
          } //tooltip
               } //plugins
          } //options
        }); //new Chart
      } //if (winChart)

      if (lossesChart) {
        lossesChart.data.datasets[0].data[0] = chrisLosses;
        lossesChart.data.datasets[0].data[1] = juliaLosses;
        lossesChart.data.datasets[0].data[2] = nickLosses;
        lossesChart.data.datasets[0].data[3] = noOneLosses;
        lossesChart.update();
      } else {
        lossesChart = new Chart(lossesDonutChartCtx, {
          type: 'doughnut',
          data: lossesData,
          options: {
            plugins: {
  datalabels: {
      anchor: 'center',      // position of label relative to bar segment
      align: 'center',       // alignment of label inside segment
  //    color: 'white',        // label color
      font: {
      //  weight: 'bold',
        size: 30
      },
       formatter: (value, ctx) => {
          const label = ctx.chart.data.labels[ctx.dataIndex];
          return label + ': ' + value;
         //  return value;
        }
      }, //datalabels
              legend: {
                display: false,
                labels: {
                  enabled: false
   //               font: {
    //                size: 30
    //              }, //font
                } //labels
             }, //legend
    //          title: {
    //          display: true,
    //          text: "Outright Losses"
    //          }, //title
               tooltip: {
                 enabled: false
          } //tooltip
            } //plugins
          } //options
        }); //new Chart

      } //if (lossesChart)
        
      const guessesData = {
        labels: ["Chris", "Julia", "Nick"],
        datasets: [{
          label: '1',
          type: 'bar',
          stack: 'combined',
          data: [chrisGoes[0], juliaGoes[0], nickGoes[0]],
          backgroundColor: "#FFD1DC"
        }, //set 1
        {
          label: '2',
          type: 'bar',
          stack: 'combined',
          data: [chrisGoes[1], juliaGoes[1], nickGoes[1]],
          backgroundColor: "#A7C7E7"
        }, //set 2
        {
          label: '3',
          type: 'bar',
          stack: 'combined',
          data: [chrisGoes[2], juliaGoes[2], nickGoes[2]],
          backgroundColor: "#AAF0D1"
        }, //set 3
        {
          label: '4',
          type: 'bar',
          stack: 'combined',
          data: [chrisGoes[3], juliaGoes[3], nickGoes[3]],
          backgroundColor: "#FFE5B4"
        }, //set 4
        {
          label: '5',
          type: 'bar',
          stack: 'combined',
          data: [chrisGoes[4], juliaGoes[4], nickGoes[4]],
          backgroundColor: "#E3E4FA"
        }, //set 5
        {
          label: '6',
          type: 'bar',
          stack: 'combined',
          data: [chrisGoes[5], juliaGoes[5], nickGoes[5]],
          backgroundColor: "#FFFACD"
        }, //set 6
        {
          label: '7',
          type: 'bar',
          stack: 'combined',
          data: [chrisGoes[6], juliaGoes[6], nickGoes[6]],
          backgroundColor: "#F6C1B2"
        }] //datasets
      }; //const guessesData

      const guessesConfig = {
//      type: "bar",
        data: guessesData,
        options: {
          plugins: {
 
//            title: {
//              display: true,
//              text: "Guess Distribution"
//            }, //title
  datalabels: {
      anchor: 'center',      // position of label relative to bar segment
      align: 'center',       // alignment of label inside segment
  //    color: 'white',        // label color
      font: {
      //  weight: 'bold',
        size: 30
      },
       formatter: (value, ctx) => {
         if (value == 0) return null;
          const label = ctx.dataset.label;
         if (label == "7") return 'Fails: ' + value;
         if (label == "1") return label + ' guess: ' + value;
          return label + ' guesses: ' + value;
    //      return value;
        }
     }, //datalabels
    //     return value;        // show the segment value
   //   }
 //  },
            legend: {
              display: false,
                labels: {
                  enabled: false
   //               font: {
    //                size: 30
    //              }, //font
    //            }, //labels
  //             labels: {
  //             font: {
   //               size: 30
    //            }, //font
   //       generateLabels: function(chart) {
    //        const original = Chart.defaults.plugins.legend.labels.generateLabels(chart);
     //       original.forEach(label => {
    //          if (label.text === '7') {
    //            label.text = 'Fail'; // change "7" to "Fail"
    //         }
     //       });
     //       return original;
        //  }
              } //labels
            }, //legend
               tooltip: {
                 enabled: false
   //             titleFont: {
   //               size: 30
   //           }, //titleFont
   //           bodyFont: {
   //             size: 30 // font size for tooltip body text
   //           }, //bodyFont
   //             footerFont: {
   //               size: 30 // font size for tooltip footer text
   //             } //footerFont
              } //tooltip
       }, //plugins
          responsive: true,
          scales: {
            x: {
              stacked: true,
              ticks: {
                font: {
                  size: 30 // Adjust this to change font size of labels below each bar
                }
              }
            },
            y: {
              display: false,
              stacked: true,
              ticks: {
                font: {
                  size: 30 // Adjust this to change font size of labels below each bar
                }
              }
            }
          } //scales
        } //options
      }; //const guessesConfig


      if (guessesChart) {
        guessesChart.data.datasets[0].data[0] = chrisGoes[0];
        guessesChart.data.datasets[0].data[1] = juliaGoes[0];
        guessesChart.data.datasets[0].data[2] = nickGoes[0];
        guessesChart.data.datasets[1].data[0] = chrisGoes[1];
        guessesChart.data.datasets[1].data[1] = juliaGoes[1];
        guessesChart.data.datasets[1].data[2] = nickGoes[1];
        guessesChart.data.datasets[2].data[0] = chrisGoes[2];
        guessesChart.data.datasets[2].data[1] = juliaGoes[2];
        guessesChart.data.datasets[2].data[2] = nickGoes[2];
        guessesChart.data.datasets[3].data[0] = chrisGoes[3];
        guessesChart.data.datasets[3].data[1] = juliaGoes[3];
        guessesChart.data.datasets[3].data[2] = nickGoes[3];
        guessesChart.data.datasets[4].data[0] = chrisGoes[4];
        guessesChart.data.datasets[4].data[1] = juliaGoes[4];
        guessesChart.data.datasets[4].data[2] = nickGoes[4];
        guessesChart.data.datasets[5].data[0] = chrisGoes[5];
        guessesChart.data.datasets[5].data[1] = juliaGoes[5];
        guessesChart.data.datasets[5].data[2] = nickGoes[5];
        guessesChart.data.datasets[6].data[0] = chrisGoes[6];
        guessesChart.data.datasets[6].data[1] = juliaGoes[6];
        guessesChart.data.datasets[6].data[2] = nickGoes[6];
        guessesChart.update();
      } else {
        guessesChart = new Chart(guessesBarChartCtx, guessesConfig); //new Chart            
      } //if (guessesChart)
        
       document.getElementById("nothing").style.display = 'none';
      document.getElementById("everything").style.display = 'block';

      //let ignoreScrollEvent = false;

      const ROW_HEIGHT = 60; // Adjust based on your row height
      const BUFFER_SIZE = 10; // Extra rows to render above/below viewport

      function loadData() {
  // Initialize virtual scrolling
  initVirtualScroll();
  
  // Scroll to bottom to show latest records
  scrollToBottom();
}

function initVirtualScroll() {
  const container2 = document.getElementById('scrollTable2');
  const tbody2 = document.getElementById('table-body2');
  const spacer2 = document.getElementById('spacer2');
  
  // Set spacer height to represent total data height
  spacer2.style.height = `${(allData.length-10) * ROW_HEIGHT}px`;
  
  // Initial render
  renderVisibleRows();
  
  // Re-render on scroll
let isThrottled = false;

container2.addEventListener('scroll', () => {
  if (!isThrottled) {
    renderVisibleRows();
    isThrottled = true;
    setTimeout(() => {
      isThrottled = false;
    }, 50); // adjust delay as needed
  }
});

  
}

function renderVisibleRows() {
  const container2 = document.getElementById('scrollTable2');
  const tbody2 = document.getElementById('table-body2');
  
  const scrollTop = container2.scrollTop;
  const viewportHeight = container2.clientHeight;
  
  // Calculate which rows should be visible
  const startIndex = Math.max(0, Math.floor(scrollTop / ROW_HEIGHT) - BUFFER_SIZE);
  const endIndex = Math.min(
    allData.length,
    Math.ceil((scrollTop + viewportHeight) / ROW_HEIGHT) + BUFFER_SIZE
  );
  
  // Clear tbody
  tbody2.innerHTML = '';
  
   // ignoreScrollEvent = true;
// Add offset to position rows correctly
  tbody2.style.transform = `translateY(${startIndex * ROW_HEIGHT}px)`;

  //  ignoreScrollEvent = false;

  
  // Render only visible rows
  for (let i = startIndex; i < endIndex; i++) {
    const row = allData[i];
    const tr = document.createElement('tr');
    tr.style.height = `${ROW_HEIGHT}px`;
    
            chrisBG = "white";
        juliaBG = "white";
       nickBG = "white";
          
        if (row.Chris != "-") {
          if (row.Chris < row.Julia && row.Chris < row.Nick) {
         chrisBG = "lightgreen";
       } else if (row.Julia < row.Chris && row.Julia < row.Nick) {
          juliaBG = "lightgreen";
        } else if (row.Nick < row.Chris && row.Nick < row.Julia) {
         nickBG = "lightgreen";
        }

       if (row.Chris > row.Julia && row.Chris > row.Nick) {
          chrisBG = "lightpink";
        } else if (row.Julia > row.Chris && row.Julia > row.Nick) {
          juliaBG = "lightpink";
        } else if (row.Nick > row.Chris && row.Nick > row.Julia) {
         nickBG = "lightpink";
        }
        if (row.Chris == 7) {chrisBG = "lemonchiffon"};
        if (row.Julia == 7) {juliaBG = "lemonchiffon"};
        if (row.Nick  == 7) {nickBG =  "lemonchiffon"};
      } //(row.Chris != "-")

// Adjust to match your data structure
    tr.innerHTML = `
      <td width=300px style="border: none" align='center'>${row.TheDate}</td>
      <td width=150px style="border: none" align='left'>${row.TheWord}</td>
      <td width=120px align='center' style='border: none; background-color: ${chrisBG}'>${row["Chris"]}</td>
      <td width=120px align='center' style='border: none; background-color: ${juliaBG}'>${row["Julia"]}</td>
      <td width=120px align='center' style='border: none; background-color: ${nickBG}'>${row["Nick"]}</td>
    `;
    
    tbody2.appendChild(tr);
  }
}

function scrollToBottom() {
  const container2 = document.getElementById('scrollTable2');
  
    ignoreScrollEvent = true;
  // Scroll to the very bottom
  container2.scrollTop = container2.scrollHeight-600;
      ignoreScrollEvent = false;

}

// Call on page load
loadData();


//         tableBody2.innerHTML = '';
 
//      const prev = await fetch('previous.json');
//      const words = await prev.json();
 
//      allData.forEach(myRow => {
      
  //      chrisBG = "white";
  //      juliaBG = "white";
   //     nickBG = "white";
          
  //      if (myRow.Chris != "-") {
 //         if (myRow.Chris < myRow.Julia && myRow.Chris < myRow.Nick) {
//          chrisBG = "lightgreen";
 //       } else if (myRow.Julia < myRow.Chris && myRow.Julia < myRow.Nick) {
 //         juliaBG = "lightgreen";
//        } else if (myRow.Nick < myRow.Chris && myRow.Nick < myRow.Julia) {
//          nickBG = "lightgreen";
//        }

//        if (myRow.Chris > myRow.Julia && myRow.Chris > myRow.Nick) {
 //         chrisBG = "lightpink";
 //       } else if (myRow.Julia > myRow.Chris && myRow.Julia > myRow.Nick) {
 //         juliaBG = "lightpink";
 //       } else if (myRow.Nick > myRow.Chris && myRow.Nick > myRow.Julia) {
//          nickBG = "lightpink";
//        }
 //       } //(myRow.Chris != "-")

        //if (indx >= (data.length - 10)) {
//          tableBody2.innerHTML += `<tr><td  width=300px style="border: none" align='center'>${myRow["TheDate"]}</td><td width=150px style="border: none" align='left'>${myRow["TheWord"]}</td><td width=120px align='center' style='border: none; background-color: ${chrisBG}'>${myRow["Chris"]}</td><td width=120px align='center' style='border: none; background-color: ${juliaBG}'>${myRow["Julia"]}</td><td width=120px align='center' style='border: none; background-color: ${nickBG}'>${myRow["Nick"]}</td></tr>`;
 //         tableBody2.innerHTML += `<tr><td  width=300px style="border: none" align='center'>${myRow["TheDate"]}</td><td width=150px style="border: none" align='left'>${myRow["TheWord"]}</td></tr>`;
        //}
 //     }); //words.forEach



      const container = document.getElementById('scrollTable');
      container.scrollTop = container.scrollHeight;
 //      const container2 = document.getElementById('scrollTable2');
  //    container2.scrollTop = container2.scrollHeight;

    } //async function fetchDataAndUpdateUI
      
    entryForm.onsubmit = async (e) => {
      e.preventDefault();
      const TheDate = entryForm.thedate.value;
      const TheWord = entryForm.theword.value.toUpperCase();
      const Chris = entryForm.chris.value;
      const Julia = entryForm.julia.value;
      const Nick = entryForm.nick.value;

      await fetch('https://sheetdb.io/api/v1/fxv69jnm5s4f6?sheet=2025', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify([{ TheDate, TheWord, Chris, Julia, Nick }])
      }); //await fetch

      entryForm.reset();  // Clear form inputs
    
      fetchDataAndUpdateUI();  // Refresh table and chart
     
    }; //entryForm.onsubmit

// Initial data load
    fetchDataAndUpdateUI();


  </script>
    
</body>
  
</html>
